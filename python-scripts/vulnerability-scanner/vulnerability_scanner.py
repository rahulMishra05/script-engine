import portScanner


targets_ip = input("[+] Enter target to scan for vulnerable open ports : ")
port_number = int(input("[+] Enter number of ports you want to scan (500 - First 500 ports) : "))
vul_file = input("[+] Enter path of the file with vulnerable software list : ")

# New line character for better look 
print("\n")

# Object of the class to scan the port
target = portScanner.PortScan(targets_ip, port_number)
target.scan()

# Comparing the vulnerabilites with the file
with open(vul_file, 'r') as file:
    count = 0
    for banner in target.banners:
        file.seek(0)
        for line in file.readline():
            if line.strip() in banner:
                print(f'[!!] Vulnerability Banner: {banner} ON PORT: {str(target.open_ports[count])}')
        count += 1